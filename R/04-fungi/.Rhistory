order = T, max.cutoff = "q99", features = (trebouxia_genexp_30k))
trebo_ipro$transcript_id[1]
trebouxia_genexp_30k[1]
# check their annotations
trebouxia_genexp_30k_annotations <- trebo_ipro[trebo_ipro$transcript_id2 %in% trebouxia_genexp_30k,]
View(trebouxia_genexp_30k_annotations)
trebouxia_genexp_30k
trebouxia_genexp_20k <- names(trebouxia_genexp_sum[trebouxia_genexp_sum <= 30000 & trebouxia_genexp_sum >= 20000])
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca",
order = T, max.cutoff = "q99", features = (trebouxia_genexp_20k))
trebouxia_genexp_15k <- names(trebouxia_genexp_sum[trebouxia_genexp_sum <= 30000 & trebouxia_genexp_sum >= 15000])
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca",
order = T, max.cutoff = "q99", features = (trebouxia_genexp_15k))
trebouxia_genexp_15k_annotations <- trebo_ipro[trebo_ipro$transcript_id2 %in% trebouxia_genexp_15k,]
View(trebouxia_genexp_15k_annotations)
View(trebouxia_genexp_30k_annotations)
test <- trebo_quant[c("GTX0536PRED-000057"),]
test <- trebo_quant[c("GTX0536PRED-000057"),] %>% as.data.frame())
test <- trebo_quant[c("GTX0536PRED-000057"),] %>% as.data.frame()
test <- trebo_quant[c("GTX0536PRED-008815"),] %>% as.data.frame()
View(test)
test <- trebo_quant[c("GTX0536PRED-0012370"),] %>% as.data.frame()
test <- trebo_quant[c("GTX0536PRED-012370"),] %>% as.data.frame()
trebo_quant <- readRDS("/Users/wap24for/Documents/alltrebouxia_matrix.rds")
treboquant_log <- log2(trebo_quant+1)
View(treboquant_log)
test <- trebo_quant[c("GTX0536PRED-012370"),] %>% as.data.frame()
test <- treboquant_log[c("GTX0536PRED-012370"),] %>% as.data.frame()
View(trebouxia_genexp_15k_annotations)
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca", order = T, features = "GTX0536PRED-001998", max.cutoff = "q99")
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca", order = T, features = "GTX0536PRED-002907", max.cutoff = "q99")
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca", order = T, features = "GTX0536PRED-009519", max.cutoff = "q99")
View(trebo_ipro)
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca", order = T, features = "GTX0536PRED-003116", max.cutoff = "q99")
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca", order = T, features = "GTX0536PRED-002353", max.cutoff = "q99")
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca", order = T, features = "GTX0536PRED-008221", max.cutoff = "q99")
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca", order = T, features = "GTX0536PRED-11268", max.cutoff = "q99")
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca", order = T, features = "GTX0536PRED-011268", max.cutoff = "q99")
xanthoria_quant <- readRDS("/Users/wap24for/Documents/xanthoria_complexity_pbulks.rds")
xanthoria_quant_log <- log2(xanthoria_quant+1)
# calculate expression of genes across all cells
xanthoria_genexp_sum <- rowSums(xanthoria_dgcmatrix)
xanthoria_genexp_mean <- rowMeans(xanthoria_dgcmatrix)
# Trebouxia
xanthoria_dgcmatrix <- GetAssayData(seurat_xanpari_doubletqc_v2)
xanthoria_quant <- readRDS("/Users/wap24for/Documents/xanthoria_complexity_pbulks.rds")
xanthoria_quant_log <- log2(xanthoria_quant+1)
# calculate expression of genes across all cells
xanthoria_genexp_sum <- rowSums(xanthoria_dgcmatrix)
xanthoria_genexp_mean <- rowMeans(xanthoria_dgcmatrix)
xanthoria_genexp_sd <- rowSds(xanthoria_dgcmatrix)
hist(xanthoria_genexp_sum)
max(xanthoria_genexp_sum)
length(xanthoria_genexp_sum > 200000)
length(xanthoria_genexp_sum > 250000)
length(xanthoria_genexp_sum[xanthoria_genexp_sum > 250000])
length(xanthoria_genexp_sum[xanthoria_genexp_sum > 200000])
names(xanthoria_genexp_sum[xanthoria_genexp_sum > 200000)
names(xanthoria_genexp_sum[xanthoria_genexp_sum > 200000])
FeaturePlot(seurat_xanpari_doubletqc_v2, features = "Xanthoria.STRG.3757", reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = "Xanthoria.STRG.3757", reduction = "integrated.cca", order = T, max.cutoff = "q50")
View(xanpari_ipro)
names(xanthoria_genexp_sum[xanthoria_genexp_sum > 100000])
names(xanthoria_genexp_sum[xanthoria_genexp_sum > 50000])
test <- xanthoria_quant_log["Xanthoria.STRG.3757",] %>% as.data.frame()
View(test)
test2 <- xanthoria_quant["Xanthoria.STRG.3757",] %>% as.data.frame()
View(test2)
names(xanthoria_genexp_sum[xanthoria_genexp_sum > 30000])
names(xanthoria_genexp_sum[xanthoria_genexp_sum > 20000])
names(xanthoria_genexp_sum[xanthoria_genexp_sum > 10000])
#lets find some other candidates to propose as backup
xanthoria_genexp_10k<- names(xanthoria_genexp_sum[xanthoria_genexp_sum > 10000])
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_10k, reduction = "integrated.cca", order = T, max.cutoff = "q50")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_10k, reduction = "integrated.cca", order = T, max.cutoff = "q99")
#lets find some other candidates to propose as backup
xanthoria_genexp_10k<- names(xanthoria_genexp_sum[xanthoria_genexp_sum > 8000])
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_10k, reduction = "integrated.cca", order = T, max.cutoff = "q99")
View(xanthoria_quant)
salmoncount_df
head(salmoncount_df)
head(salmoncount_df)[1]
head(salmoncount_df)[[1]]
salmonlist[[1]]$counts
?tximport
colSums(Quant)
library(edgeR)
?fpkmToTpm
?rpkm
get_tximport <- function(salmonfile, genemapfile){
tx2gene <- get_tx2gene(genemapfile)
#tximport <- tximport(salmonfile, type = "salmon", tx2gene = tx2gene, countsFromAbundance =  "lengthScaledTPM")
tximport <- tximport(salmonfile, type = "salmon", tx2gene = tx2gene)
tximport
}
salmonlist <- vector("list", length = length(samplename))
names(salmonlist) <- samplename
genemap <- "/Users/wap24for/Downloads/Xanthoria parietina.gene_to_tx.txt"
for (i in 1:length(samplename)){
salmonlist[[i]] <- get_tximport(files[i],genemap)
}
species <- names(salmonlist)
salmonabun_df <- vector("list", length(salmonlist))
names(salmonabun_df) <- species
salmoncount_df <- vector("list", length(salmonlist))
names(salmoncount_df) <- species
for (i in 1:length(species)){
abun_df <- salmonlist[[species[i]]]$abundance %>% as.data.frame()
count_df <- salmonlist[[species[i]]]$counts %>% as.data.frame()
log2abun_df <- log2(1+abun_df)
samplereps <- colnames(log2abun_df)
salmonabun_df[[i]] <- abun_df
salmoncount_df[[i]] <- count_df
salmoncount_df[[i]]$sample <- word(species[i], sep = "_")
salmoncount_df[[i]]$gene <- rownames(salmoncount_df[[i]])
rownames(salmoncount_df) <- NULL
colnames(salmoncount_df[[i]])[1] <- "counts"
}
salmoncounts_all <- do.call(rbind, salmoncount_df)
Quant2 <- pivot_wider(salmoncounts_all, names_from = "sample", values_from = "counts") %>% as.data.frame()
rownames(Quant2) <- Quant2$gene
Quant2$gene <- NULL
View(Quant2)
colSums(Quant2)
library(DESeq2)
salmonlist[[1]]$length
salmonlength_df <- vector("list", length(salmonlist))
names(salmonlength_df) <- species
for (i in 1:length(species)){
abun_df <- salmonlist[[species[i]]]$abundance %>% as.data.frame()
length_df <- salmonlist[[species[i]]]$length %>% as.data.frame()
count_df <- salmonlist[[species[i]]]$counts %>% as.data.frame()
log2abun_df <- log2(1+abun_df)
samplereps <- colnames(log2abun_df)
salmonabun_df[[i]] <- abun_df
salmoncount_df[[i]] <- count_df
salmoncount_df[[i]]$sample <- word(species[i], sep = "_")
salmoncount_df[[i]]$gene <- rownames(salmoncount_df[[i]])
rownames(salmoncount_df) <- NULL
colnames(salmoncount_df[[i]])[1] <- "counts"
}
salmonabundance_all <- do.call(rbind, salmonabundance_df)
salmonabundance_all <- do.call(rbind, salmonabun_df)
View(salmonabun_df)
salmonlength_df[[i]]$sample <- word(species[i], sep = "_")
salmonlength_df[[i]]$gene <- rownames(salmonlength_df[[i]])
for (i in 1:length(species)){
abun_df <- salmonlist[[species[i]]]$abundance %>% as.data.frame()
length_df <- salmonlist[[species[i]]]$length %>% as.data.frame()
count_df <- salmonlist[[species[i]]]$counts %>% as.data.frame()
log2abun_df <- log2(1+abun_df)
samplereps <- colnames(log2abun_df)
salmonabun_df[[i]] <- abun_df
salmoncount_df[[i]] <- count_df
salmoncount_df[[i]]$sample <- word(species[i], sep = "_")
salmoncount_df[[i]]$gene <- rownames(salmoncount_df[[i]])
salmonabun_df[[i]]$sample <- word(species[i], sep = "_")
salmonabun_df[[i]]$gene <- rownames(salmonabun_df[[i]])
salmonlength_df[[i]]$sample <- word(species[i], sep = "_")
salmonlength_df[[i]]$gene <- rownames(salmonlength_df[[i]])
rownames(salmoncount_df) <- NULL
colnames(salmoncount_df[[i]])[1] <- "counts"
}
salmonabundance_all <- do.call(rbind, salmonabun_df)
View(salmonabun_df)
View(salmoncount_df)
View(salmonabun_df)
View(salmonlength_df)
salmonlist[[1]]$length
View(salmonlength_df)
salmonlength_df[["ERR4235130_quant.sf"]][["sample"]]
for (i in 1:length(species)){
abun_df <- salmonlist[[species[i]]]$abundance %>% as.data.frame()
length_df <- salmonlist[[species[i]]]$length %>% as.data.frame()
count_df <- salmonlist[[species[i]]]$counts %>% as.data.frame()
log2abun_df <- log2(1+abun_df)
samplereps <- colnames(log2abun_df)
salmonabun_df[[i]] <- abun_df
salmoncount_df[[i]] <- count_df
salmonlength_df[[i]] <- length_df
salmoncount_df[[i]]$sample <- word(species[i], sep = "_")
salmoncount_df[[i]]$gene <- rownames(salmoncount_df[[i]])
salmonabun_df[[i]]$sample <- word(species[i], sep = "_")
salmonabun_df[[i]]$gene <- rownames(salmonabun_df[[i]])
salmonlength_df[[i]]$sample <- word(species[i], sep = "_")
salmonlength_df[[i]]$gene <- rownames(salmonlength_df[[i]])
rownames(salmoncount_df) <- NULL
colnames(salmoncount_df[[i]])[1] <- "counts"
}
View(salmonlength_df)
head(count_df)
salmoncount_df <- vector("list", length(salmonlist))
names(salmoncount_df) <- species
for (i in 1:length(species)){
abun_df <- salmonlist[[species[i]]]$abundance %>% as.data.frame()
length_df <- salmonlist[[species[i]]]$length %>% as.data.frame()
count_df <- salmonlist[[species[i]]]$counts %>% as.data.frame()
log2abun_df <- log2(1+abun_df)
samplereps <- colnames(log2abun_df)
salmonabun_df[[i]] <- abun_df
salmoncount_df[[i]] <- count_df
salmonlength_df[[i]] <- length_df
salmoncount_df[[i]]$sample <- word(species[i], sep = "_")
salmoncount_df[[i]]$gene <- rownames(salmoncount_df[[i]])
salmonabun_df[[i]]$sample <- word(species[i], sep = "_")
salmonabun_df[[i]]$gene <- rownames(salmonabun_df[[i]])
salmonlength_df[[i]]$sample <- word(species[i], sep = "_")
salmonlength_df[[i]]$gene <- rownames(salmonlength_df[[i]])
rownames(salmoncount_df) <- NULL
colnames(salmoncount_df[[i]])[1] <- "counts"
}
salmonabun_df[[1]]
head(salmoncount_df[[1]])
head(count_df)
for (i in 1:length(species)){
abun_df <- salmonlist[[species[i]]]$abundance %>% as.data.frame()
length_df <- salmonlist[[species[i]]]$length %>% as.data.frame()
count_df <- salmonlist[[species[i]]]$counts %>% as.data.frame()
log2abun_df <- log2(1+abun_df)
samplereps <- colnames(log2abun_df)
salmonabun_df[[i]] <- abun_df
salmoncount_df[[i]] <- count_df
salmonlength_df[[i]] <- length_df
salmoncount_df[[i]]$sample <- word(species[i], sep = "_")
salmoncount_df[[i]]$gene <- rownames(salmoncount_df[[i]])
rownames(salmoncount_df) <- NULL
colnames(salmoncount_df[[i]])[1] <- "counts"
salmonabun_df[[i]]$sample <- word(species[i], sep = "_")
salmonabun_df[[i]]$gene <- rownames(salmonabun_df[[i]])
rownames(salmonabun_df) <- NULL
colnames(salmonabun_df[[i]])[1] <- "counts"
salmonlength_df[[i]]$sample <- word(species[i], sep = "_")
salmonlength_df[[i]]$gene <- rownames(salmonlength_df[[i]])
rownames(salmonlength_df) <- NULL
colnames(salmonlength_df[[i]])[1] <- "counts"
}
salmoncounts_all <- do.call(rbind, salmoncount_df)
salmonabundance_all <- do.call(rbind, salmonabun_df)
View(salmonabundance_all)
rownames(salmonabundance_all) <- salmonabundance_all$gene
View(salmonabundance_all)
for (i in 1:length(species)){
abun_df <- salmonlist[[species[i]]]$abundance %>% as.data.frame()
length_df <- salmonlist[[species[i]]]$length %>% as.data.frame()
count_df <- salmonlist[[species[i]]]$counts %>% as.data.frame()
log2abun_df <- log2(1+abun_df)
samplereps <- colnames(log2abun_df)
salmonabun_df[[i]] <- abun_df
salmoncount_df[[i]] <- count_df
salmonlength_df[[i]] <- length_df
salmoncount_df[[i]]$sample <- word(species[i], sep = "_")
salmoncount_df[[i]]$gene <- rownames(salmoncount_df[[i]])
rownames(salmoncount_df) <- NULL
colnames(salmoncount_df[[i]])[1] <- "counts"
salmonabun_df[[i]]$sample <- word(species[i], sep = "_")
salmonabun_df[[i]]$gene <- rownames(salmonabun_df[[i]])
rownames(salmonabun_df) <- NULL
colnames(salmonabun_df[[i]])[1] <- "TPM"
salmonlength_df[[i]]$sample <- word(species[i], sep = "_")
salmonlength_df[[i]]$gene <- rownames(salmonlength_df[[i]])
rownames(salmonlength_df) <- NULL
colnames(salmonlength_df[[i]])[1] <- "length"
}
salmoncounts_all <- do.call(rbind, salmoncount_df)
View(salmoncounts_all)
salmonlength_all <- do.call(rbind, salmonlength_df)
#TPM values - we want to choose ones that are less than 1000
salmonabundance_all_lengths <- merge(salmonabundance_all, salmonlength_all)
salmonabundance_all_lengths
salmonrpkm <- rpkm(salmonabundance_all_lengths, gene.length = "length")
View(salmonabundance_all_lengths)
xanthoria_bulk_tpm_df <- pivot_wider(salmonabundance_all_lengths, names_from = "sample", values_from = "TPM") %>% as.data.frame()
#TPM values - we want to choose ones that are less than 1000
salmonabundance_all_lengths <- merge(salmonabundance_all, salmonlength_all)
xanthoria_bulk_tpm_df <- pivot_wider(salmonabundance_all_lengths, names_from = "sample", values_from = "counts") %>% as.data.frame()
View(xanthoria_bulk_tpm_df)
xanthoria_bulk_tpm_df <- pivot_wider(salmonabundance_all, names_from = "sample", values_from = "counts") %>% as.data.frame()
View(xanthoria_bulk_tpm_df)
for (i in 1:length(species)){
abun_df <- salmonlist[[species[i]]]$abundance %>% as.data.frame()
length_df <- salmonlist[[species[i]]]$length %>% as.data.frame()
count_df <- salmonlist[[species[i]]]$counts %>% as.data.frame()
log2abun_df <- log2(1+abun_df)
samplereps <- colnames(log2abun_df)
salmonabun_df[[i]] <- abun_df
salmoncount_df[[i]] <- count_df
salmonlength_df[[i]] <- length_df
salmoncount_df[[i]]$sample <- word(species[i], sep = "_")
salmoncount_df[[i]]$gene <- rownames(salmoncount_df[[i]])
rownames(salmoncount_df) <- NULL
colnames(salmoncount_df[[i]])[1] <- "counts"
salmonabun_df[[i]]$sample <- word(species[i], sep = "_")
salmonabun_df[[i]]$gene <- rownames(salmonabun_df[[i]])
rownames(salmonabun_df) <- NULL
colnames(salmonabun_df[[i]])[1] <- "TPM"
salmonlength_df[[i]]$sample <- word(species[i], sep = "_")
salmonlength_df[[i]]$gene <- rownames(salmonlength_df[[i]])
rownames(salmonlength_df) <- NULL
colnames(salmonlength_df[[i]])[1] <- "length"
}
salmonabundance_all <- do.call(rbind, salmonabun_df)
xanthoria_bulk_tpm_df <- pivot_wider(salmonabundance_all, names_from = "sample", values_from = "counts") %>% as.data.frame()
xanthoria_bulk_tpm_df <- pivot_wider(salmonabundance_all, names_from = "sample", values_from = "TPM") %>% as.data.frame()
View(xanthoria_bulk_tpm_df)
xanthoria_bulk_tpm_1000 <- xanthoria_bulk_tpm_df[xanthoria_bulk_tpm_df <= 1000,]
View(xanthoria_bulk_tpm_1000)
xanthoria_bulk_tpm_1000 <- salmonabundance_all[salmonabundance_all$TPM <= 1000,]
xanthoria_bulk1000_tpm_df <- pivot_wider(xanthoria_bulk_tpm_1000, names_from = "sample", values_from = "TPM") %>% as.data.frame()
View(xanthoria_bulk_tpm_1000)
View(xanthoria_bulk1000_tpm_df)
xanthoria_bulk1000_tpm_df[is.na(xanthoria_bulk1000_tpm_df)] <- 0
View(xanthoria_bulk1000_tpm_df)
xanthoria_bulk1000_tpm_df <- xanthoria_bulk1000_tpm_df[order(xanthoria_bulk1000_tpm_df$ERR4235132),]
?order
xanthoria_bulk1000_tpm_df <- xanthoria_bulk1000_tpm_df[order(xanthoria_bulk1000_tpm_df$ERR4235132, decreasing = T),]
xanthoria_bulk1000_tpm_df <- pivot_wider(xanthoria_bulk_tpm_1000, names_from = "sample", values_from = "TPM") %>% as.data.frame()
xanthoria_bulk1000_tpm_df[is.na(xanthoria_bulk1000_tpm_df)] <- 0
xanthoria_bulk1000_tpm_df <- xanthoria_bulk1000_tpm_df[order(xanthoria_bulk1000_tpm_df$ERR4235132, decreasing = T),]
#
FeaturePlot(seurat_xanpari_doubletqc_v2, features = rownames(xanthoria_bulk1000_tpm_df)[1:12], reduction = "integrated.cca", order = T, max.cutoff = "q99")
rownames(xanthoria_bulk1000_tpm_df)
#
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_bulk1000_tpm_df$gene[1:12], reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_bulk1000_tpm_df$gene[13:25], reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_10k, reduction = "integrated.cca", order = T, max.cutoff = "q99")
xanthoria_genexp_10k_anno <- xanpari_ipro[xanpari_ipro$transcript_id %in% xanthoria_genexp_10k,]
View(xanthoria_genexp_10k_anno)
xanthoria_genexp_8k<- names(xanthoria_genexp_sum[xanthoria_genexp_sum > 1000 & xanthoria_genexp_sum < 8000])
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_8k, reduction = "integrated.cca", order = T, max.cutoff = "q99")
xanthoria_genexp_8k
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_8k[1:10], reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_8k[11:20], reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_8k[21:30], reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_8k[31:40], reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_8k[1:10], reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_10k, reduction = "integrated.cca", order = T, max.cutoff = "q99")
xanthoria_genexp_8k_anno <- xanpari_ipro[xanpari_ipro$transcript_id %in% xanthoria_genexp_8k,]
View(xanthoria_genexp_8k_anno)
FeaturePlot(seurat_xanpari_doubletqc_v2, features =c("Xanthoria.STRG.7650",Xanthoria.STRG.2020"), reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features =c("Xanthoria.STRG.7650","Xanthoria.STRG.2020"), reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features =c("Xanthoria.STRG.5563"), reduction = "integrated.cca", order = T, max.cutoff = "q99")
View(xanpari_ipro)
# elongation factors
eef_id <- unique(xanpari_ipro[grepl(xanpari_ipro$ipro_description, "elongation", ignore.case = T),]$transcript_id)
# elongation factors
eef_id <- (xanpari_ipro[grepl(xanpari_ipro$ipro_description, "elongation", ignore.case = T),])
eef_id <- unique(xanpari_ipro[xanpari_ipro$ipro_accesion %in% c("IPR004160","IPR004161",]$transcript_id)
eef_id <- unique(xanpari_ipro[xanpari_ipro$ipro_accesion %in% c("IPR004160","IPR004161"),]$transcript_id)
eef_id
FeaturePlot(seurat_xanpari_doubletqc_v2, features = eef_id, reduction = "integrated.cca", order = T, max.cutoff = "q99")
View(xanthoria_bulk_tpm_df)
salmonabundance_all_lengths
View(salmonlength_all)
FeaturePlot(seurat_xanpari_doubletqc_v2, features = "Xanthoria.STRG.3827", reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = "Xanthoria.STRG.2931", reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = "Xanthoria.STRG.6354", reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = "Xanthoria.STRG.4984", reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_8k[41:50], reduction = "integrated.cca", order = T, max.cutoff = "q99")
View(xanthoria_genexp_8k_anno)
View(xanthoria_bulk_tpm_df)
ggplot(catd_xanpari_subclusters_long, aes(x = sample_id, y = value, fill = cluster))+
geom_bar(stat = "identity", color = "black")+theme_bw()+
scale_fill_manual(values = catd_xanpari_subcols)+
facet_wrap(~tissue, scales = "free")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_8k[51:60], reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_8k[61:70], reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_8k[71:80], reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_xanpari_doubletqc_v2, features = xanthoria_genexp_8k[81:90], reduction = "integrated.cca", order = T, max.cutoff = "q99")
## bulk salmon trebouxia
## bulk salmon xanthoria
trebosalmondir <- "/Users/wap24for/Documents/trebouxia_bulk_salmon/"
trebosamplename <- list.files(trebosalmondir)
trebofiles <- file.path(trebosalmondir,trebosamplename)
names(trebofiles) <- trebosamplename
trebosalmonlist <- vector("list", length = length(trebosamplename))
names(trebosalmonlist) <- trebosamplename
trebogenemap <- "/Users/wap24for/Documents/xanthoria_snrna/Trebouxia_sp._A48_gene2tx.txt"
trebogenemap <- "/Users/wap24for/Documents/xanthoria_snrna/Trebouxia_sp._A48_gene2tx.txt"
for (i in 1:length(trebosamplename)){
trebosalmonlist[[i]] <- get_tximport(trebofiles[i],trebogenemap)
}
trebospecies <- names(trebosalmonlist)
trebosalmonabun_df <- vector("list", length(trebosalmonlist))
names(trebosalmonabun_df) <- trebospecies
trebosalmoncount_df <- vector("list", length(trebosalmonlist))
names(trebosalmoncount_df) <- trebospecies
trebosalmonlength_df <- vector("list", length(trebosalmonlist))
names(trebosalmonlength_df) <- trebospecies
for (i in 1:length(trebospecies)){
abun_df <- trebosalmonlist[[trebospecies[i]]]$abundance %>% as.data.frame()
length_df <- trebosalmonlist[[trebospecies[i]]]$length %>% as.data.frame()
count_df <- trebosalmonlist[[trebospecies[i]]]$counts %>% as.data.frame()
log2abun_df <- log2(1+abun_df)
samplereps <- colnames(log2abun_df)
trebosalmonabun_df[[i]] <- abun_df
trebosalmoncount_df[[i]] <- count_df
trebosalmonlength_df[[i]] <- length_df
trebosalmoncount_df[[i]]$sample <- word(trebospecies[i], sep = "_")
trebosalmoncount_df[[i]]$gene <- rownames(trebosalmoncount_df[[i]])
rownames(trebosalmoncount_df) <- NULL
colnames(trebosalmoncount_df[[i]])[1] <- "counts"
trebosalmonabun_df[[i]]$sample <- word(trebospecies[i], sep = "_")
trebosalmonabun_df[[i]]$gene <- rownames(trebosalmonabun_df[[i]])
rownames(trebosalmonabun_df) <- NULL
colnames(trebosalmonabun_df[[i]])[1] <- "TPM"
trebosalmonlength_df[[i]]$sample <- word(trebospecies[i], sep = "_")
trebosalmonlength_df[[i]]$gene <- rownames(trebosalmonlength_df[[i]])
rownames(trebosalmonlength_df) <- NULL
colnames(trebosalmonlength_df[[i]])[1] <- "length"
}
trebosalmoncounts_all <- do.call(rbind, trebosalmoncount_df)
trebosalmonlength_all <- do.call(rbind, trebosalmonlength_df)
trebosalmonabundance_all <- do.call(rbind, trebosalmonabun_df)
trebosalmonabundance_all
trebo_bulk_tpm_1000 <- trebosalmonabundance_all[trebosalmonabundance_all$TPM <= 1000,]
trebo_bulk1000_tpm_df <- pivot_wider(trebo_bulk_tpm_1000, names_from = "sample", values_from = "TPM") %>% as.data.frame()
trebo_bulk1000_tpm_df[is.na(trebo_bulk1000_tpm_df)] <- 0
trebo_bulk1000_tpm_df <- trebo_bulk1000_tpm_df[order(trebo_bulk1000_tpm_df$ERR4235134, decreasing = T),]
View(trebo_bulk1000_tpm_df)
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca",
order = T, max.cutoff = "q99", features = (trebo_bulk1000_tpm_df$gene[1:10]))
trebo_bulk1000_tpm_df$gene <- gsub("_","-", trebo_bulk1000_tpm_df$gene)
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca",
order = T, max.cutoff = "q99", features = (trebo_bulk1000_tpm_df$gene[1:10]))
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca",
order = T, max.cutoff = "q99", features = (trebo_bulk1000_tpm_df$gene[11:20]))
View(trebo_ipro)
trebo_bulk1000_tpm_df$gene[11:20
]
View(trebosalmonlength_all)
View(trebo_bulk1000_tpm_df)
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca",
order = T, max.cutoff = "q99", features = (trebo_bulk1000_tpm_df$gene[21:30]))
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca",
order = T, max.cutoff = "q99", features = (trebo_bulk1000_tpm_df$gene[31:40]))
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca",
order = T, max.cutoff = "q99", features = (trebo_bulk1000_tpm_df$gene[41:50]))
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca",
order = T, max.cutoff = "q99", features = (trebo_bulk1000_tpm_df$gene[41:50]))
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca",
order = T, max.cutoff = "q99", features = (trebo_bulk1000_tpm_df$gene[51:60]))
FeaturePlot(seurat_trebo_doubletqc_v2, reduction = "integrated.cca",
order = T, max.cutoff = "q99", features = (trebo_bulk1000_tpm_df$gene[61:70]))
# check some elongation factors as well
trebo_elongationfactors <- c("IPR000640","IPR000795","IPR001059","IPR001816",
"IPR003618","IPR004160","IPR004161","IPR004540")
trebo_elongationfactors_features <- trebo_iprop[trebo_ipro$ipro_accesion %in% trebo_elongationfactors,]
trebo_elongationfactors_features <- unique(trebo_ipro[trebo_ipro$ipro_accesion %in% trebo_elongationfactors,]$transcript_id2)
length(trebo_elongationfactors_features)
FeaturePlot(seurat_trebo_doubletqc_v2, features = trebo_elongationfactors_features[1:10], reduction = "integrated.cca", order = T, max.cutoff = "q99")
trebo_bulk_tpm_df <- pivot_wider(trebosalmonabundance_all, names_from = "sample", values_from = "TPM") %>% as.data.frame()
View(trebo_bulk_tpm_df)
FeaturePlot(seurat_trebo_doubletqc_v2, features = trebo_elongationfactors_features[11:20], reduction = "integrated.cca", order = T, max.cutoff = "q99")
FeaturePlot(seurat_trebo_doubletqc_v2, features = trebo_elongationfactors_features[21:24], reduction = "integrated.cca", order = T, max.cutoff = "q99")
colSums trebo_bulk_tpm_df
colSums(trebo_bulk_tpm_df)
colSums(trebo_bulk_tpm_df[-1])
mean(trebo_bulk_tpm_df)
mean(trebo_bulk_tpm_df[4:ncol(trebo_bulk_tpm_df),])
rowMeans()
test <- data.frame("gene" = trebo_bulk_tpm_df$gene, "meanTPM" = rowMeans(trebo_bulk_tpm_df[4:,]))
rowMeans(trebo_bulk_tpm_df[,4:])
rowMeans(trebo_bulk_tpm_df[,4:])
rowMeans(trebo_bulk_tpm_df)
rowMeans(trebo_bulk_tpm_df[-1:4,])
rowMeans(trebo_bulk_tpm_df[,-1:4])
test <- data.frame("gene" = trebo_bulk_tpm_df$gene, "meanTPM" = rowMeans(trebo_bulk_tpm_df[,4:ncol(trebo_bulk_tpm_df)], na.rm=TRUE)
)
View(test)
trebo_bulk_length_df <- pivot_wider(trebosalmonlengths_all, names_from = "sample", values_from = "length") %>% as.data.frame()
trebo_bulk_length_df <- pivot_wider(trebosalmonlength_all, names_from = "sample", values_from = "length") %>% as.data.frame()
head(trebo_bulk_length_df)
test <- data.frame("gene" = trebo_bulk_tpm_df$gene, "meanTPM" = rowMeans(trebo_bulk_tpm_df[,4:ncol(trebo_bulk_tpm_df)], na.rm=TRUE))
test2 <- data.frame("gene" = trebo_bulk_length_df$gene, "meanLength" = rowMeans(trebo_bulk_length_df[,4:ncol(trebo_bulk_length_df)], na.rm=TRUE))
test3 <- merge(test, test2)
View(test3)
write.csv(test3, file = "/Users/wap24for/Documents/trebouxia_meanTPM.csv", row.names = FALSE)
write.csv(test3, file = "/Users/wap24for/Documents/trebouxia_meanTPM.csv", row.names = FALSE, quote = FALSE)
trebouxia_vizgen_candidate_id <- c("GTX0536PRED_005557","GTX0536PRED_004919",
"GTX0536PRED_009025","GTX0536PRED_007450","GTX0536PRED_004792")
trebouxia_vizgen_candidate_df <- test3[test3$gene %in% trebouxia_vizgen_candidate_id,]
trebouxia_vizgen_candidate_df
trebouxia_vizgen_candidate_df <- merge(trebouxia_vizgen_candidate_df, trebo_ipro[,c("transcript_id", "ipro_description","ipro_accession")])
trebouxia_vizgen_candidate_df <- merge(trebouxia_vizgen_candidate_df, trebo_ipro[,c("transcript_id", "ipro_description","ipro_accession")], by.x = "gene", by.y = "transcript_id")
trebouxia_vizgen_candidate_df <- merge(trebouxia_vizgen_candidate_df, trebo_iproby.x = "gene", by.y = "transcript_id")
trebouxia_vizgen_candidate_df <- merge(trebouxia_vizgen_candidate_df, trebo_ipro,by.x = "gene", by.y = "transcript_id")
View(trebouxia_vizgen_candidate_df)
write.csv(trebouxia_vizgen_candidate_df, "/Users/wap24for/Documents/trebouxia_vizgen_candidates.csv", quote = F, row.names = F)
trebouxia_vizgen_candidate_df <- test3[test3$gene %in% trebouxia_vizgen_candidate_id,]
xanthoria_meantpm <- data.frame("gene" = xanthoria_bulk_tpm_df$gene, "meanTPM" = rowMeans(trebo_bulk_tpm_df[,4:ncol(trebo_bulk_tpm_df)], na.rm=TRUE))
xanthoria_meantpm <- data.frame("gene" = xanthoria_bulk_tpm_df$gene, "meanTPM" = rowMeans(xanthoria_bulk_tpm_df[,4:ncol(xanthoria_bulk_tpm_df)], na.rm=TRUE))
xanthoria_meantpm
xanthoria_meantpm <- data.frame("gene" = xanthoria_bulk_tpm_df$gene, "meanTPM" = rowMeans(xanthoria_bulk_tpm_df[,4:ncol(xanthoria_bulk_tpm_df)], na.rm=TRUE))
xanthoria_meanlength <- data.frame("gene" = xanthoria_bulk_length_df$gene, "meanLength" = rowMeans(xanthoria_bulk_length_df[,4:ncol(xanthoria_bulk_length_df)], na.rm=TRUE))
xanthoria_meantpm
xanthoria_meantpm <- data.frame("gene" = xanthoria_bulk_tpm_df$gene, "meanTPM" = rowMeans(xanthoria_bulk_tpm_df[,4:ncol(xanthoria_bulk_tpm_df)], na.rm=TRUE))
xanthoria_meanlength <- data.frame("gene" = salmonlength_all$gene, "meanLength" = rowMeans(xanthoria_bulk_length_df[,4:ncol(xanthoria_bulk_length_df)], na.rm=TRUE))
xanthoria_meanlength <- data.frame("gene" = salmonlength_all$gene, "meanLength" = rowMeans(salmonlength_all[,4:ncol(salmonlength_all)], na.rm=TRUE))
salmonlength_all
colnames(salmonlength_all)
xanthoria_bulk_length_df <- pivot_wider(salmonlength_all, names_from = "sample", values_from = "length") %>% as.data.frame()
xanthoria_meanlength <- data.frame("gene" = xanthoria_bulk_length_df$gene, "meanLength" = rowMeans(xanthoria_bulk_length_df[,4:ncol(xanthoria_bulk_length_df)], na.rm=TRUE))
xanthoria_meantpmlength <- merge(xanthori_meantpm, xanthoria_meanlength)
xanthoria_meantpmlength <- merge(xanthoria_meantpm, xanthoria_meanlength)
write.csv(xanthoria_meantpmlength, "/Users/wap24for/Documents/xanthoria_meanTPM.csv", row.names = FALSE, quote = FALSE)
xanthoria_vizgen_candidate_id <- c("Xanthoria.STRG.2485","Xanthoria.STRG.3423",
"Xanthoria.STRG.3607","Xanthoria.STRG.6685","Xanthoria.STRG.540")
xanthoria_vizgen_candidate_df <- xanthoria_meantpmlength[xanthoria_meantpmlength$gene %in% xanthoria_vizgen_candidate_id,]
xanthoria_vizgen_candidate_df <- merge(xanthoria_vizgen_candidate_df, xanpari_ipro,by.x = "gene", by.y = "transcript_id")
head(xanthoria_vizgen_candidate_df)
write.csv(xanthoria_vizgen_candidate_df, "/Users/wap24for/Documents/xanthoria_vizgen_candidates.csv", quote = FALSE, row.names = FALSE)
save.image("~/Documents/oct24_snrna.RData")
